
> catch-the-lion@0.1.0 tauri
> tauri dev


> catch-the-lion@0.1.0 dev
> vite


  VITE v5.4.8  ready in 489 ms

  âžœ  Local:   http://localhost:1420/
after layer norm: Tensor {
  data:
[[[1.2474853, 0.4692521, 1.0777359, ..., -0.0014419832, -0.0014419832, -0.0014419832],
  [-0.49518502, -0.77045214, 0.28068233, ..., -0.33443913, -0.33443913, -0.33443913],
  [-0.30550963, -0.35230044, -1.1610111, ..., -0.41429654, -0.41429654, -0.41429654],
  ...
  [-2.2075367, -1.3578933, -1.4435774, ..., -0.536598, -0.536598, -0.536598],
  [-2.3574848, -1.6262203, -1.0617244, ..., 0.7238569, 0.7238569, 0.7238569],
  [-1.1083221, -0.85527366, -0.2288452, ..., -0.049023654, -0.049023654, -0.049023654]]],
  shape:  [1, 256, 48],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after permute: Tensor {
  data:
[[[1.2474853, -0.49518502, -0.30550963, ..., -2.2075367, -2.3574848, -1.1083221],
  [0.4692521, -0.77045214, -0.35230044, ..., -1.3578933, -1.6262203, -0.85527366],
  [1.0777359, 0.28068233, -1.1610111, ..., -1.4435774, -1.0617244, -0.2288452],
  ...
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654],
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654],
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
encoder layer 0 Tensor {
  data:
[[[1.2474853, -0.49518502, -0.30550963, ..., -2.2075367, -2.3574848, -1.1083221],
  [0.4692521, -0.77045214, -0.35230044, ..., -1.3578933, -1.6262203, -0.85527366],
  [1.0777359, 0.28068233, -1.1610111, ..., -1.4435774, -1.0617244, -0.2288452],
  ...
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654],
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654],
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
residual_path Tensor {
  data:
[[[1.2474853, -0.49518502, -0.30550963, ..., -2.2075367, -2.3574848, -1.1083221],
  [0.4692521, -0.77045214, -0.35230044, ..., -1.3578933, -1.6262203, -0.85527366],
  [1.0777359, 0.28068233, -1.1610111, ..., -1.4435774, -1.0617244, -0.2288452],
  ...
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654],
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654],
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
start multihead attention
query: Tensor {
  data:
[[[[-0.25462866, -0.416615, 0.15664935, ..., -0.44859388, -0.26349738, 0.007298893],
   [-0.28966776, -1.4001241, 0.78747207, ..., -0.738148, 0.2399626, -0.6524341],
   [-0.02219542, -1.0067453, 0.26810285, ..., -0.13295217, 0.41533458, 0.10097626],
   ...
   [-0.1012574, -0.7500852, -0.14128707, ..., -0.20375417, 0.29475895, 0.18372987],
   [-0.1012574, -0.7500852, -0.14128707, ..., -0.20375417, 0.29475895, 0.18372987],
   [-0.1012574, -0.7500852, -0.14128707, ..., -0.20375417, 0.29475895, 0.18372987]],
  [[0.22900258, 0.1403669, 0.49181244, ..., 0.72619736, -0.32000718, -0.86252254],
   [-0.007908832, 0.6207565, 0.6178891, ..., 0.3305052, -0.1210101, -0.7663809],
   [0.18160366, 0.76747644, 0.4988868, ..., 0.40813538, -0.19975832, -0.7505693],
   ...
   [-0.2953906, 0.4802744, -0.5793067, ..., -0.21144243, 0.39764705, 0.1387441],
   [-0.2953906, 0.4802744, -0.5793067, ..., -0.21144243, 0.39764705, 0.1387441],
   [-0.2953906, 0.4802744, -0.5793067, ..., -0.21144243, 0.39764705, 0.1387441]],
  [[1.0063244, 0.38659847, -2.1569562, ..., -0.1885414, 1.0220368, 0.585067],
   [0.7375113, 0.30232343, -1.8060591, ..., -0.29144132, 1.1956626, 1.4604158],
   [0.9379552, 0.3831043, -0.936195, ..., 0.07758086, 0.4243454, 0.8140281],
   ...
   [0.52870834, -0.4852719, -0.16033913, ..., 0.47229514, 0.1268151, -0.006874799],
   [0.52870834, -0.4852719, -0.16033913, ..., 0.47229514, 0.1268151, -0.006874799],
   [0.52870834, -0.4852719, -0.16033913, ..., 0.47229514, 0.1268151, -0.006874799]],
  [[-0.08255648, 0.09862994, -1.118495, ..., 0.32083184, 0.5785577, -0.19631107],
   [-0.17799146, 0.035786577, -0.6204183, ..., -0.36582506, 1.6374059, 0.3707421],
   [-0.10800744, -0.05529965, -0.3265988, ..., -0.47043097, 1.4566585, 0.7786374],
   ...
   [-1.0205773, -0.1664143, 0.31577203, ..., -0.3667182, 0.6700663, -0.5029833],
   [-1.0205773, -0.1664143, 0.31577203, ..., -0.3667182, 0.6700663, -0.5029833],
   [-1.0205773, -0.1664143, 0.31577203, ..., -0.3667182, 0.6700663, -0.5029833]]]],
  shape:  [1, 4, 48, 64],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
query: Tensor {
  data:
[[[[0.6861304, 0.39804852, 0.65906924, ..., 0.1733086, 0.6759819, 0.93419695],
   [0.8414052, 0.40233415, 0.653568, ..., -0.0035535023, 0.18577982, 1.3136646],
   [0.46329966, -0.0006763339, 0.48763505, ..., -0.49135295, -0.64995235, 1.3409754],
   ...
   [-0.7550544, 0.29632127, 0.26102197, ..., -0.21457666, 0.9624388, -0.56868017],
   [-0.7550544, 0.29632127, 0.26102197, ..., -0.21457666, 0.9624388, -0.56868017],
   [-0.7550544, 0.29632127, 0.26102197, ..., -0.21457666, 0.9624388, -0.56868017]],
  [[-0.058656048, 1.2935003, -0.5167084, ..., -1.2477851, -0.02764066, -0.7877828],
   [0.1647184, 1.5972381, -0.893656, ..., -1.3274797, -0.12259227, -0.94273096],
   [0.40002894, 0.75802314, 0.16471002, ..., -0.76556027, -0.492099, -0.29654402],
   ...
   [-0.21840553, 0.15788703, 1.0695388, ..., -0.9357791, 0.009900233, 0.67524266],
   [-0.21840553, 0.15788703, 1.0695388, ..., -0.9357791, 0.009900233, 0.67524266],
   [-0.21840553, 0.15788703, 1.0695388, ..., -0.9357791, 0.009900233, 0.67524266]],
  [[-1.043567, -0.109294645, -0.43229207, ..., -0.5548291, 0.63803864, 0.6957757],
   [-0.2901412, 0.7519812, -0.39982897, ..., -0.51307297, 0.57774305, 0.7803199],
   [-0.65126246, 0.6978293, -0.36562616, ..., -0.5257277, 1.5031942, 0.193137],
   ...
   [-0.52172023, 0.50353163, 0.59618056, ..., 0.18778837, 1.0417676, 1.149887],
   [-0.52172023, 0.50353163, 0.59618056, ..., 0.18778837, 1.0417676, 1.149887],
   [-0.52172023, 0.50353163, 0.59618056, ..., 0.18778837, 1.0417676, 1.149887]],
  [[0.22851537, 0.64581627, 0.37115666, ..., 1.1504033, 0.0025353937, -1.2453551],
   [0.385153, 0.15883459, 0.488909, ..., 0.853775, 0.6989965, -1.2079858],
   [-0.81116086, -0.062054474, 0.4590084, ..., 0.95285225, 0.4617619, -0.5484708],
   ...
   [-0.17530772, -0.89346904, 0.15066308, ..., -0.44755363, -0.5485513, -0.4884712],
   [-0.17530772, -0.89346904, 0.15066308, ..., -0.44755363, -0.5485513, -0.4884712],
   [-0.17530772, -0.89346904, 0.15066308, ..., -0.44755363, -0.5485513, -0.4884712]]]],
  shape:  [1, 4, 48, 64],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
value: Tensor {
  data:
[[[[1.1212865, 0.55239624, -0.066038184, ..., -0.12140932, -1.1751888, -0.78744835],
   [1.0981772, 0.74924225, 0.71314716, ..., -0.010198121, -0.69025534, -1.7838885],
   [0.16195837, 1.0328054, -0.0014214665, ..., 0.11777192, -0.48889184, -0.7634013],
   ...
   [-0.9305947, -0.54236573, 0.6163666, ..., -0.6748724, 0.36931846, -0.058306478],
   [-0.9305947, -0.54236573, 0.6163666, ..., -0.6748724, 0.36931846, -0.058306478],
   [-0.9305947, -0.54236573, 0.6163666, ..., -0.6748724, 0.36931846, -0.058306478]],
  [[-0.86794364, -1.2159119, -0.761062, ..., -0.04622084, 1.4327134, -0.3003435],
   [-0.8877341, -1.0325508, -0.69723815, ..., -0.010280848, 1.2638354, -0.2167266],
   [-0.71212894, -1.5406389, -0.885754, ..., -0.12683819, 0.8661456, 0.41072717],
   ...
   [0.047828525, -0.3772412, 0.5431055, ..., -0.18050121, -0.8333345, 1.1230595],
   [0.047828525, -0.3772412, 0.5431055, ..., -0.18050121, -0.8333345, 1.1230595],
   [0.047828525, -0.3772412, 0.5431055, ..., -0.18050121, -0.8333345, 1.1230595]],
  [[0.49693134, 0.7743376, -1.0360402, ..., 0.74190074, -0.9511083, -0.53299665],
   [0.31873378, 0.81879026, -0.28147426, ..., 0.70720696, -0.9901666, -0.430156],
   [0.34081322, 0.20103702, -0.46403453, ..., 0.7085874, -0.83025455, -0.0883307],
   ...
   [-0.8015556, -2.0363035, -0.696582, ..., -0.095614456, -1.5127512, -0.039539956],
   [-0.8015556, -2.0363035, -0.696582, ..., -0.095614456, -1.5127512, -0.039539956],
   [-0.8015556, -2.0363035, -0.696582, ..., -0.095614456, -1.5127512, -0.039539956]],
  [[0.67733943, -0.60967976, -0.9147407, ..., 0.16699365, -1.3424854, 0.15590037],
   [0.562789, -0.7620908, -0.68380934, ..., 0.1692447, -1.0007539, 0.9564496],
   [-0.5581826, -0.056903962, -0.21233906, ..., -0.2531746, -0.7983511, 0.9671163],
   ...
   [-0.12802169, 0.26223126, -1.18199, ..., -0.55481666, 0.19676264, 0.62607867],
   [-0.12802169, 0.26223126, -1.18199, ..., -0.55481666, 0.19676264, 0.62607867],
   [-0.12802169, 0.26223126, -1.18199, ..., -0.55481666, 0.19676264, 0.62607867]]]],
  shape:  [1, 4, 48, 64],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
RELU VERSION
after mha forward Tensor {
  data:
[[[-0.28813693, 0.12662578, -0.06792209, ..., -0.00713961, -0.0047626006, 0.020661091],
  [-0.26486453, 0.08701056, -0.009649852, ..., -0.048152417, 0.032386344, 0.0037883501],
  [-0.16871223, 0.06619401, 0.026838783, ..., -0.004521963, -0.025130134, -0.042220853],
  ...
  [-0.13625576, -0.0034366138, 0.045770485, ..., 0.03323488, -1.3047364e-5, 0.06032794],
  [-0.13625576, -0.0034366138, 0.045770485, ..., 0.03323488, -1.3047364e-5, 0.06032794],
  [-0.13625576, -0.0034366138, 0.045770485, ..., 0.03323488, -1.3047364e-5, 0.06032794]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after mha_foward, x + residual path Tensor {
  data:
[[[0.9593483, -0.36855924, -0.3734317, ..., -2.2146764, -2.3622475, -1.087661],
  [0.20438758, -0.6834416, -0.36195028, ..., -1.4060458, -1.593834, -0.8514853],
  [0.90902364, 0.34687632, -1.1341723, ..., -1.4480994, -1.0868546, -0.27106604],
  ...
  [-0.13769774, -0.33787575, -0.36852604, ..., -0.50336313, 0.7238439, 0.011304285],
  [-0.13769774, -0.33787575, -0.36852604, ..., -0.50336313, 0.7238439, 0.011304285],
  [-0.13769774, -0.33787575, -0.36852604, ..., -0.50336313, 0.7238439, 0.011304285]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after pwff Tensor {
  data:
[[[-0.03141799, -2.8196318, -0.35033864, ..., -1.2823747, 0.03979716, 0.92254966],
  [0.23484254, -2.461228, -0.51056397, ..., -1.378036, 0.113789625, 0.8163398],
  [0.39899296, -1.7497811, -0.6910832, ..., -1.9144747, -0.26010376, 1.0502585],
  ...
  [-0.4200021, -0.27615833, -1.0715431, ..., -0.6955141, 0.5487157, 0.32111397],
  [-0.4200021, -0.27615833, -1.0715431, ..., -0.6955141, 0.5487157, 0.32111397],
  [-0.4200021, -0.27615833, -1.0715431, ..., -0.6955141, 0.5487157, 0.32111397]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after dropout Tensor {
  data:
[[[-0.03141799, -2.8196318, -0.35033864, ..., -1.2823747, 0.03979716, 0.92254966],
  [0.23484254, -2.461228, -0.51056397, ..., -1.378036, 0.113789625, 0.8163398],
  [0.39899296, -1.7497811, -0.6910832, ..., -1.9144747, -0.26010376, 1.0502585],
  ...
  [-0.4200021, -0.27615833, -1.0715431, ..., -0.6955141, 0.5487157, 0.32111397],
  [-0.4200021, -0.27615833, -1.0715431, ..., -0.6955141, 0.5487157, 0.32111397],
  [-0.4200021, -0.27615833, -1.0715431, ..., -0.6955141, 0.5487157, 0.32111397]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
x + residual Tensor {
  data:
[[[0.8500386, -3.2023907, -0.72151595, ..., -3.3775644, -2.2362025, -0.08977622],
  [0.38214335, -3.1780536, -0.9047804, ..., -2.767785, -1.4872781, -0.018472254],
  [1.4599748, -1.3536588, -1.9784565, ..., -3.5480075, -1.5056148, 0.783827],
  ...
  [-0.5884917, -0.7058934, -1.5240269, ..., -1.3090849, 1.4654343, 0.36308363],
  [-0.5884917, -0.7058934, -1.5240269, ..., -1.3090849, 1.4654343, 0.36308363],
  [-0.5884917, -0.7058934, -1.5240269, ..., -1.3090849, 1.4654343, 0.36308363]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after norm2 Tensor {
  data:
[[[0.53402364, -1.9942383, -0.45030165, ..., -2.086975, -1.4124244, -0.035844784],
  [0.24514304, -1.9691153, -0.5603342, ..., -1.7004251, -0.9317493, 0.012227915],
  [0.81748563, -0.7827468, -1.1492637, ..., -2.0110347, -0.8808736, 0.44311014],
  ...
  [-0.36733285, -0.43690538, -0.9225967, ..., -0.7806152, 0.84307736, 0.2030326],
  [-0.36733285, -0.43690538, -0.9225967, ..., -0.7806152, 0.84307736, 0.2030326],
  [-0.36733285, -0.43690538, -0.9225967, ..., -0.7806152, 0.84307736, 0.2030326]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
encoder layer 1 Tensor {
  data:
[[[0.53402364, -1.9942383, -0.45030165, ..., -2.086975, -1.4124244, -0.035844784],
  [0.24514304, -1.9691153, -0.5603342, ..., -1.7004251, -0.9317493, 0.012227915],
  [0.81748563, -0.7827468, -1.1492637, ..., -2.0110347, -0.8808736, 0.44311014],
  ...
  [-0.36733285, -0.43690538, -0.9225967, ..., -0.7806152, 0.84307736, 0.2030326],
  [-0.36733285, -0.43690538, -0.9225967, ..., -0.7806152, 0.84307736, 0.2030326],
  [-0.36733285, -0.43690538, -0.9225967, ..., -0.7806152, 0.84307736, 0.2030326]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
residual_path Tensor {
  data:
[[[0.53402364, -1.9942383, -0.45030165, ..., -2.086975, -1.4124244, -0.035844784],
  [0.24514304, -1.9691153, -0.5603342, ..., -1.7004251, -0.9317493, 0.012227915],
  [0.81748563, -0.7827468, -1.1492637, ..., -2.0110347, -0.8808736, 0.44311014],
  ...
  [-0.36733285, -0.43690538, -0.9225967, ..., -0.7806152, 0.84307736, 0.2030326],
  [-0.36733285, -0.43690538, -0.9225967, ..., -0.7806152, 0.84307736, 0.2030326],
  [-0.36733285, -0.43690538, -0.9225967, ..., -0.7806152, 0.84307736, 0.2030326]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
start multihead attention
query: Tensor {
  data:
[[[[0.32378477, -0.22151157, -0.3892755, ..., -1.3076296, 0.122659326, -0.8612732],
   [0.1685326, -0.86301583, -0.009862753, ..., -1.677227, 0.43591142, -1.3077149],
   [0.56672794, -0.67466664, -0.50334996, ..., -1.0205398, 0.39966416, -0.37811825],
   ...
   [0.4235478, -0.053781737, -0.8967507, ..., -1.138108, 0.878041, 0.15169166],
   [0.4235478, -0.053781737, -0.8967507, ..., -1.138108, 0.878041, 0.15169166],
   [0.4235478, -0.053781737, -0.8967507, ..., -1.138108, 0.878041, 0.15169166]],
  [[0.010949832, 0.32657552, 1.3834664, ..., -0.36343557, -0.056570973, 0.82786256],
   [-0.32889923, 0.6193702, 1.4279195, ..., -0.5017218, -0.10007684, 0.9317836],
   [0.21483168, 1.0206745, 1.5844499, ..., -0.5294709, -0.2932472, 0.6868367],
   ...
   [-0.1893472, 1.119013, 0.37328398, ..., -0.88804615, 0.260649, 1.2665528],
   [-0.1893472, 1.119013, 0.37328398, ..., -0.88804615, 0.260649, 1.2665528],
   [-0.1893472, 1.119013, 0.37328398, ..., -0.88804615, 0.260649, 1.2665528]],
  [[0.28048185, 1.1687204, -0.50677556, ..., -0.047595695, 0.32657397, 1.0722615],
   [0.23203379, 1.1342818, -0.33240816, ..., 0.22329482, 0.55120724, 1.5164773],
   [0.30309275, 0.8602062, -0.043995, ..., 0.21203114, -0.11542937, 1.1382089],
   ...
   [-0.80601496, -0.87943465, 0.28418812, ..., 0.70326054, -0.24975094, 0.2606133],
   [-0.80601496, -0.87943465, 0.28418812, ..., 0.70326054, -0.24975094, 0.2606133],
   [-0.80601496, -0.87943465, 0.28418812, ..., 0.70326054, -0.24975094, 0.2606133]],
  [[-1.025194, -0.116645426, -1.0341339, ..., 0.84364855, 0.93410033, 0.03846124],
   [-1.0413339, -0.20677511, -0.8209195, ..., 0.7475113, 1.3590165, 0.21670705],
   [-0.7852917, -0.18610688, -0.4214147, ..., 0.63271195, 1.2793972, 0.7598846],
   ...
   [-1.6369929, -0.93771464, 0.2146469, ..., 0.14761545, 0.40239954, -0.3238038],
   [-1.6369929, -0.93771464, 0.2146469, ..., 0.14761545, 0.40239954, -0.3238038],
   [-1.6369929, -0.93771464, 0.2146469, ..., 0.14761545, 0.40239954, -0.3238038]]]],
  shape:  [1, 4, 48, 64],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
query: Tensor {
  data:
[[[[0.3347597, -0.2841893, 0.14285909, ..., 0.5564537, 0.090271235, -0.064126484],
   [0.37861043, -0.1226854, 0.409381, ..., 0.437161, -0.24035555, 0.16471899],
   [0.0711734, -0.72411776, 0.15256296, ..., 0.0047293184, -1.0419587, 0.36531746],
   ...
   [-1.1229049, -0.9444003, -0.6342477, ..., 0.66946, 1.0355526, -1.0393574],
   [-1.1229049, -0.9444003, -0.6342477, ..., 0.66946, 1.0355526, -1.0393574],
   [-1.1229049, -0.9444003, -0.6342477, ..., 0.66946, 1.0355526, -1.0393574]],
  [[-0.4774327, 0.55174583, 0.5267019, ..., -1.3580142, -0.036863342, 0.072589785],
   [-0.3418256, 0.8900772, 0.29469633, ..., -1.169544, 0.07147355, 0.047842856],
   [-0.1706742, 0.74760866, 1.1111115, ..., -0.6966208, -0.38493708, 0.36053535],
   ...
   [-1.0541632, 0.6194297, 1.6984955, ..., -0.8956088, 0.091291204, 0.49496582],
   [-1.0541632, 0.6194297, 1.6984955, ..., -0.8956088, 0.091291204, 0.49496582],
   [-1.0541632, 0.6194297, 1.6984955, ..., -0.8956088, 0.091291204, 0.49496582]],
  [[-0.6997397, -0.1483347, -0.774646, ..., -0.36068416, 0.7655216, 0.0025569722],
   [-0.3186077, 0.40489247, -0.6249663, ..., -0.32636866, 0.93867606, 0.20086196],
   [-0.92804843, 0.19881487, -0.4224209, ..., -0.61350596, 1.4140074, -0.2046715],
   ...
   [-0.80760074, 0.659371, 0.74635124, ..., 0.066376604, 0.86278284, 0.99840444],
   [-0.80760074, 0.659371, 0.74635124, ..., 0.066376604, 0.86278284, 0.99840444],
   [-0.80760074, 0.659371, 0.74635124, ..., 0.066376604, 0.86278284, 0.99840444]],
  [[-0.7557156, -0.269117, -0.4581433, ..., 0.69440633, 0.4182424, -1.3402313],
   [-0.82291394, -0.5831, -0.2675599, ..., 0.50267494, 0.79447603, -0.9789101],
   [-1.6901181, -0.86203504, -0.06658679, ..., 0.8103142, 0.7806598, -0.6939619],
   ...
   [-1.3682362, -1.6969543, -0.03816034, ..., -0.78844494, -0.1861785, -0.96907717],
   [-1.3682362, -1.6969543, -0.03816034, ..., -0.78844494, -0.1861785, -0.96907717],
   [-1.3682362, -1.6969543, -0.03816034, ..., -0.78844494, -0.1861785, -0.96907717]]]],
  shape:  [1, 4, 48, 64],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
value: Tensor {
  data:
[[[[0.12603322, -0.32820648, 0.010913636, ..., 1.289636, -0.59116286, -0.4709641],
   [-0.23949891, -0.20061162, 0.4146151, ..., 1.2931718, -0.30252472, -1.0978304],
   [-0.5890806, 0.24302734, 0.21602117, ..., 1.1772977, -0.28052744, -0.2716232],
   ...
   [-0.7956434, -1.3527573, 0.5011412, ..., 0.027970916, 0.46071336, -0.024349414],
   [-0.7956434, -1.3527573, 0.5011412, ..., 0.027970916, 0.46071336, -0.024349414],
   [-0.7956434, -1.3527573, 0.5011412, ..., 0.027970916, 0.46071336, -0.024349414]],
  [[-0.15902387, -1.1873525, -1.1917522, ..., -0.09435415, 0.5680761, 0.29895315],
   [-0.2059563, -1.007616, -1.035292, ..., 0.0107228365, 0.44080123, 0.26865855],
   [-0.09774237, -1.2860316, -1.26242, ..., -0.14574872, 0.581807, 0.7286644],
   ...
   [0.6644274, -0.9077853, -0.22457466, ..., -0.39362177, -1.0267304, 0.9743592],
   [0.6644274, -0.9077853, -0.22457466, ..., -0.39362177, -1.0267304, 0.9743592],
   [0.6644274, -0.9077853, -0.22457466, ..., -0.39362177, -1.0267304, 0.9743592]],
  [[0.5078256, 0.03346012, -1.1007528, ..., 0.38167402, -1.337418, -0.72184986],
   [0.56177443, 0.23727156, -0.81047577, ..., 0.44904625, -1.5338813, -0.66122514],
   [0.62805516, -0.31558397, -0.8692769, ..., 0.26545548, -1.2471598, -0.4948913],
   ...
   [-0.49638262, -2.054101, -0.21989653, ..., -0.5606749, -1.8888439, -0.03411725],
   [-0.49638262, -2.054101, -0.21989653, ..., -0.5606749, -1.8888439, -0.03411725],
   [-0.49638262, -2.054101, -0.21989653, ..., -0.5606749, -1.8888439, -0.03411725]],
  [[0.2266096, 0.5669163, -0.4042968, ..., 0.5241224, -1.6004615, -0.77589244],
   [0.07139566, 0.47345722, -0.3208394, ..., 0.4797076, -1.1928345, -0.04823266],
   [-0.43947676, 0.55629474, 0.15826552, ..., 0.1481006, -1.3207914, -0.09201212],
   ...
   [-0.07605402, 0.74414945, 0.067125656, ..., -0.0041355984, -0.10825197, 0.39921248],
   [-0.07605402, 0.74414945, 0.067125656, ..., -0.0041355984, -0.10825197, 0.39921248],
   [-0.07605402, 0.74414945, 0.067125656, ..., -0.0041355984, -0.10825197, 0.39921248]]]],
  shape:  [1, 4, 48, 64],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
RELU VERSION
after mha forward Tensor {
  data:
[[[-0.31921896, -0.092618726, 0.06450652, ..., 0.59595907, -0.17093335, -0.04915728],
  [-0.35964635, -0.11719036, 0.06743077, ..., 0.58124834, -0.16875695, -0.05866586],
  [-0.30126935, -0.1449453, 0.08821037, ..., 0.5484946, -0.18623695, -0.106393896],
  ...
  [-0.26467085, -0.24601988, 0.08651117, ..., 0.5861247, -0.1234647, -0.0649204],
  [-0.26467085, -0.24601988, 0.08651117, ..., 0.5861247, -0.1234647, -0.0649204],
  [-0.26467085, -0.24601988, 0.08651117, ..., 0.5861247, -0.1234647, -0.0649204]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after mha_foward, x + residual path Tensor {
  data:
[[[0.21480468, -2.086857, -0.38579512, ..., -1.491016, -1.5833578, -0.085002065],
  [-0.11450331, -2.0863056, -0.49290344, ..., -1.1191769, -1.1005062, -0.046437945],
  [0.5162163, -0.92769206, -1.0610534, ..., -1.4625401, -1.0671105, 0.33671623],
  ...
  [-0.63200366, -0.6829253, -0.8360855, ..., -0.19449049, 0.71961266, 0.13811219],
  [-0.63200366, -0.6829253, -0.8360855, ..., -0.19449049, 0.71961266, 0.13811219],
  [-0.63200366, -0.6829253, -0.8360855, ..., -0.19449049, 0.71961266, 0.13811219]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after pwff Tensor {
  data:
[[[-1.6009068, -0.49374494, -1.2681955, ..., -1.0166767, -0.79993224, 0.09701261],
  [-1.3286871, -0.103956506, -1.1183753, ..., -0.9043744, -0.6516597, 0.02302657],
  [-1.7335933, 0.15814728, -1.3171, ..., -0.734418, -0.87341, -0.023518413],
  ...
  [-1.6039168, -0.3919872, -1.5566002, ..., -0.66352624, -1.7252313, 0.51892567],
  [-1.6039168, -0.3919872, -1.5566002, ..., -0.66352624, -1.7252313, 0.51892567],
  [-1.6039168, -0.3919872, -1.5566002, ..., -0.66352624, -1.7252313, 0.51892567]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after dropout Tensor {
  data:
[[[-1.6009068, -0.49374494, -1.2681955, ..., -1.0166767, -0.79993224, 0.09701261],
  [-1.3286871, -0.103956506, -1.1183753, ..., -0.9043744, -0.6516597, 0.02302657],
  [-1.7335933, 0.15814728, -1.3171, ..., -0.734418, -0.87341, -0.023518413],
  ...
  [-1.6039168, -0.3919872, -1.5566002, ..., -0.66352624, -1.7252313, 0.51892567],
  [-1.6039168, -0.3919872, -1.5566002, ..., -0.66352624, -1.7252313, 0.51892567],
  [-1.6039168, -0.3919872, -1.5566002, ..., -0.66352624, -1.7252313, 0.51892567]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
x + residual Tensor {
  data:
[[[-1.3851501, -2.5321121, -1.64766, ..., -2.463754, -2.3746798, 0.029852867],
  [-1.4363176, -2.1331568, -1.6015084, ..., -1.9841049, -1.7431917, -0.0063011386],
  [-1.2267299, -0.74209464, -2.3594859, ..., -2.148955, -1.9335357, 0.31844094],
  ...
  [-2.238449, -1.0726817, -2.399576, ..., -0.8597816, -1.0238574, 0.65884745],
  [-2.238449, -1.0726817, -2.399576, ..., -0.8597816, -1.0238574, 0.65884745],
  [-2.238449, -1.0726817, -2.399576, ..., -0.8597816, -1.0238574, 0.65884745]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after norm2 Tensor {
  data:
[[[-0.80300206, -1.4936714, -0.96681464, ..., -1.4493755, -1.4331805, -0.002520631],
  [-0.8687996, -1.3117003, -0.97933877, ..., -1.2164501, -1.0938338, -0.024584714],
  [-0.72972757, -0.4563893, -1.4267833, ..., -1.2964797, -1.1953301, 0.16723199],
  ...
  [-1.2500911, -0.6153043, -1.3534667, ..., -0.49269426, -0.5918776, 0.33750513],
  [-1.2500911, -0.6153043, -1.3534667, ..., -0.49269426, -0.5918776, 0.33750513],
  [-1.2500911, -0.6153043, -1.3534667, ..., -0.49269426, -0.5918776, 0.33750513]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after transformer encoder: Tensor {
  data:
[[[-0.80300206, -1.4936714, -0.96681464, ..., -1.4493755, -1.4331805, -0.002520631],
  [-0.8687996, -1.3117003, -0.97933877, ..., -1.2164501, -1.0938338, -0.024584714],
  [-0.72972757, -0.4563893, -1.4267833, ..., -1.2964797, -1.1953301, 0.16723199],
  ...
  [-1.2500911, -0.6153043, -1.3534667, ..., -0.49269426, -0.5918776, 0.33750513],
  [-1.2500911, -0.6153043, -1.3534667, ..., -0.49269426, -0.5918776, 0.33750513],
  [-1.2500911, -0.6153043, -1.3534667, ..., -0.49269426, -0.5918776, 0.33750513]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
Tensor {
  data:
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.4389528, 1.431815, 1.431815, 1.2008195, 1.2279024, 1.325713, 1.325713, 1.3424426, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
  shape:  [48],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
Tensor {
  data:
[9],
  shape:  [1],
  device:  Cpu,
  backend:  "candle",
  kind:  "Int",
  dtype:  "i64",
}
