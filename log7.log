
> catch-the-lion@0.1.0 tauri
> tauri dev


> catch-the-lion@0.1.0 dev
> vite


  VITE v5.4.8  ready in 497 ms

  âžœ  Local:   http://localhost:1420/
after layer norm: Tensor {
  data:
[[[1.2474853, 0.4692521, 1.0777359, ..., -0.0014419832, -0.0014419832, -0.0014419832],
  [-0.49518502, -0.77045214, 0.28068233, ..., -0.33443913, -0.33443913, -0.33443913],
  [-0.30550963, -0.35230044, -1.1610111, ..., -0.41429654, -0.41429654, -0.41429654],
  ...
  [-2.2075367, -1.3578933, -1.4435774, ..., -0.536598, -0.536598, -0.536598],
  [-2.3574848, -1.6262203, -1.0617244, ..., 0.7238569, 0.7238569, 0.7238569],
  [-1.1083221, -0.85527366, -0.2288452, ..., -0.049023654, -0.049023654, -0.049023654]]],
  shape:  [1, 256, 48],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after permute: Tensor {
  data:
[[[1.2474853, -0.49518502, -0.30550963, ..., -2.2075367, -2.3574848, -1.1083221],
  [0.4692521, -0.77045214, -0.35230044, ..., -1.3578933, -1.6262203, -0.85527366],
  [1.0777359, 0.28068233, -1.1610111, ..., -1.4435774, -1.0617244, -0.2288452],
  ...
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654],
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654],
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
encoder layer 0 Tensor {
  data:
[[[1.2474853, -0.49518502, -0.30550963, ..., -2.2075367, -2.3574848, -1.1083221],
  [0.4692521, -0.77045214, -0.35230044, ..., -1.3578933, -1.6262203, -0.85527366],
  [1.0777359, 0.28068233, -1.1610111, ..., -1.4435774, -1.0617244, -0.2288452],
  ...
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654],
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654],
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
residual_path Tensor {
  data:
[[[1.2474853, -0.49518502, -0.30550963, ..., -2.2075367, -2.3574848, -1.1083221],
  [0.4692521, -0.77045214, -0.35230044, ..., -1.3578933, -1.6262203, -0.85527366],
  [1.0777359, 0.28068233, -1.1610111, ..., -1.4435774, -1.0617244, -0.2288452],
  ...
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654],
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654],
  [-0.0014419832, -0.33443913, -0.41429654, ..., -0.536598, 0.7238569, -0.049023654]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
start multihead attention
query: Tensor {
  data:
[[[[-0.25462866, -0.416615, 0.15664935, ..., -0.44859388, -0.26349738, 0.007298893],
   [-0.28966776, -1.4001241, 0.78747207, ..., -0.738148, 0.2399626, -0.6524341],
   [-0.02219542, -1.0067453, 0.26810285, ..., -0.13295217, 0.41533458, 0.10097626],
   ...
   [-0.1012574, -0.7500852, -0.14128707, ..., -0.20375417, 0.29475895, 0.18372987],
   [-0.1012574, -0.7500852, -0.14128707, ..., -0.20375417, 0.29475895, 0.18372987],
   [-0.1012574, -0.7500852, -0.14128707, ..., -0.20375417, 0.29475895, 0.18372987]],
  [[0.22900258, 0.1403669, 0.49181244, ..., 0.72619736, -0.32000718, -0.86252254],
   [-0.007908832, 0.6207565, 0.6178891, ..., 0.3305052, -0.1210101, -0.7663809],
   [0.18160366, 0.76747644, 0.4988868, ..., 0.40813538, -0.19975832, -0.7505693],
   ...
   [-0.2953906, 0.4802744, -0.5793067, ..., -0.21144243, 0.39764705, 0.1387441],
   [-0.2953906, 0.4802744, -0.5793067, ..., -0.21144243, 0.39764705, 0.1387441],
   [-0.2953906, 0.4802744, -0.5793067, ..., -0.21144243, 0.39764705, 0.1387441]],
  [[1.0063244, 0.38659847, -2.1569562, ..., -0.1885414, 1.0220368, 0.585067],
   [0.7375113, 0.30232343, -1.8060591, ..., -0.29144132, 1.1956626, 1.4604158],
   [0.9379552, 0.3831043, -0.936195, ..., 0.07758086, 0.4243454, 0.8140281],
   ...
   [0.52870834, -0.4852719, -0.16033913, ..., 0.47229514, 0.1268151, -0.006874799],
   [0.52870834, -0.4852719, -0.16033913, ..., 0.47229514, 0.1268151, -0.006874799],
   [0.52870834, -0.4852719, -0.16033913, ..., 0.47229514, 0.1268151, -0.006874799]],
  [[-0.08255648, 0.09862994, -1.118495, ..., 0.32083184, 0.5785577, -0.19631107],
   [-0.17799146, 0.035786577, -0.6204183, ..., -0.36582506, 1.6374059, 0.3707421],
   [-0.10800744, -0.05529965, -0.3265988, ..., -0.47043097, 1.4566585, 0.7786374],
   ...
   [-1.0205773, -0.1664143, 0.31577203, ..., -0.3667182, 0.6700663, -0.5029833],
   [-1.0205773, -0.1664143, 0.31577203, ..., -0.3667182, 0.6700663, -0.5029833],
   [-1.0205773, -0.1664143, 0.31577203, ..., -0.3667182, 0.6700663, -0.5029833]]]],
  shape:  [1, 4, 48, 64],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
query: Tensor {
  data:
[[[[0.6861304, 0.39804852, 0.65906924, ..., 0.1733086, 0.6759819, 0.93419695],
   [0.8414052, 0.40233415, 0.653568, ..., -0.0035535023, 0.18577982, 1.3136646],
   [0.46329966, -0.0006763339, 0.48763505, ..., -0.49135295, -0.64995235, 1.3409754],
   ...
   [-0.7550544, 0.29632127, 0.26102197, ..., -0.21457666, 0.9624388, -0.56868017],
   [-0.7550544, 0.29632127, 0.26102197, ..., -0.21457666, 0.9624388, -0.56868017],
   [-0.7550544, 0.29632127, 0.26102197, ..., -0.21457666, 0.9624388, -0.56868017]],
  [[-0.058656048, 1.2935003, -0.5167084, ..., -1.2477851, -0.02764066, -0.7877828],
   [0.1647184, 1.5972381, -0.893656, ..., -1.3274797, -0.12259227, -0.94273096],
   [0.40002894, 0.75802314, 0.16471002, ..., -0.76556027, -0.492099, -0.29654402],
   ...
   [-0.21840553, 0.15788703, 1.0695388, ..., -0.9357791, 0.009900233, 0.67524266],
   [-0.21840553, 0.15788703, 1.0695388, ..., -0.9357791, 0.009900233, 0.67524266],
   [-0.21840553, 0.15788703, 1.0695388, ..., -0.9357791, 0.009900233, 0.67524266]],
  [[-1.043567, -0.109294645, -0.43229207, ..., -0.5548291, 0.63803864, 0.6957757],
   [-0.2901412, 0.7519812, -0.39982897, ..., -0.51307297, 0.57774305, 0.7803199],
   [-0.65126246, 0.6978293, -0.36562616, ..., -0.5257277, 1.5031942, 0.193137],
   ...
   [-0.52172023, 0.50353163, 0.59618056, ..., 0.18778837, 1.0417676, 1.149887],
   [-0.52172023, 0.50353163, 0.59618056, ..., 0.18778837, 1.0417676, 1.149887],
   [-0.52172023, 0.50353163, 0.59618056, ..., 0.18778837, 1.0417676, 1.149887]],
  [[0.22851537, 0.64581627, 0.37115666, ..., 1.1504033, 0.0025353937, -1.2453551],
   [0.385153, 0.15883459, 0.488909, ..., 0.853775, 0.6989965, -1.2079858],
   [-0.81116086, -0.062054474, 0.4590084, ..., 0.95285225, 0.4617619, -0.5484708],
   ...
   [-0.17530772, -0.89346904, 0.15066308, ..., -0.44755363, -0.5485513, -0.4884712],
   [-0.17530772, -0.89346904, 0.15066308, ..., -0.44755363, -0.5485513, -0.4884712],
   [-0.17530772, -0.89346904, 0.15066308, ..., -0.44755363, -0.5485513, -0.4884712]]]],
  shape:  [1, 4, 48, 64],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
value: Tensor {
  data:
[[[[1.1212865, 0.55239624, -0.066038184, ..., -0.12140932, -1.1751888, -0.78744835],
   [1.0981772, 0.74924225, 0.71314716, ..., -0.010198121, -0.69025534, -1.7838885],
   [0.16195837, 1.0328054, -0.0014214665, ..., 0.11777192, -0.48889184, -0.7634013],
   ...
   [-0.9305947, -0.54236573, 0.6163666, ..., -0.6748724, 0.36931846, -0.058306478],
   [-0.9305947, -0.54236573, 0.6163666, ..., -0.6748724, 0.36931846, -0.058306478],
   [-0.9305947, -0.54236573, 0.6163666, ..., -0.6748724, 0.36931846, -0.058306478]],
  [[-0.86794364, -1.2159119, -0.761062, ..., -0.04622084, 1.4327134, -0.3003435],
   [-0.8877341, -1.0325508, -0.69723815, ..., -0.010280848, 1.2638354, -0.2167266],
   [-0.71212894, -1.5406389, -0.885754, ..., -0.12683819, 0.8661456, 0.41072717],
   ...
   [0.047828525, -0.3772412, 0.5431055, ..., -0.18050121, -0.8333345, 1.1230595],
   [0.047828525, -0.3772412, 0.5431055, ..., -0.18050121, -0.8333345, 1.1230595],
   [0.047828525, -0.3772412, 0.5431055, ..., -0.18050121, -0.8333345, 1.1230595]],
  [[0.49693134, 0.7743376, -1.0360402, ..., 0.74190074, -0.9511083, -0.53299665],
   [0.31873378, 0.81879026, -0.28147426, ..., 0.70720696, -0.9901666, -0.430156],
   [0.34081322, 0.20103702, -0.46403453, ..., 0.7085874, -0.83025455, -0.0883307],
   ...
   [-0.8015556, -2.0363035, -0.696582, ..., -0.095614456, -1.5127512, -0.039539956],
   [-0.8015556, -2.0363035, -0.696582, ..., -0.095614456, -1.5127512, -0.039539956],
   [-0.8015556, -2.0363035, -0.696582, ..., -0.095614456, -1.5127512, -0.039539956]],
  [[0.67733943, -0.60967976, -0.9147407, ..., 0.16699365, -1.3424854, 0.15590037],
   [0.562789, -0.7620908, -0.68380934, ..., 0.1692447, -1.0007539, 0.9564496],
   [-0.5581826, -0.056903962, -0.21233906, ..., -0.2531746, -0.7983511, 0.9671163],
   ...
   [-0.12802169, 0.26223126, -1.18199, ..., -0.55481666, 0.19676264, 0.62607867],
   [-0.12802169, 0.26223126, -1.18199, ..., -0.55481666, 0.19676264, 0.62607867],
   [-0.12802169, 0.26223126, -1.18199, ..., -0.55481666, 0.19676264, 0.62607867]]]],
  shape:  [1, 4, 48, 64],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
RELU VERSION
after mha forward Tensor {
  data:
[[[0.11149956, -0.022513859, 0.18913063, ..., -0.080876835, -0.010128358, 0.08777128],
  [0.15006061, -0.017844003, 0.16092737, ..., -0.039311077, 0.04844804, 0.04683845],
  [0.0796598, -0.037061565, 0.060886774, ..., -0.032209236, -0.07094138, 0.013500566],
  ...
  [0.024992365, -0.013016526, -0.074834675, ..., -0.007140916, -0.123980515, -0.0017647315],
  [0.024992365, -0.013016526, -0.074834675, ..., -0.007140916, -0.123980515, -0.0017647315],
  [0.024992365, -0.013016526, -0.074834675, ..., -0.007140916, -0.123980515, -0.0017647315]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after mha_foward, x + residual path Tensor {
  data:
[[[1.3589848, -0.5176989, -0.11637899, ..., -2.2884135, -2.367613, -1.0205508],
  [0.6193127, -0.78829616, -0.19137307, ..., -1.3972044, -1.5777723, -0.8084352],
  [1.1573957, 0.24362075, -1.1001244, ..., -1.4757867, -1.1326658, -0.21534462],
  ...
  [0.023550382, -0.34745565, -0.4891312, ..., -0.54373896, 0.5998764, -0.050788388],
  [0.023550382, -0.34745565, -0.4891312, ..., -0.54373896, 0.5998764, -0.050788388],
  [0.023550382, -0.34745565, -0.4891312, ..., -0.54373896, 0.5998764, -0.050788388]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after pwff Tensor {
  data:
[[[-0.122419156, -2.8830998, -0.37505093, ..., -1.3713326, 0.022751084, 0.85332894],
  [0.14310788, -2.5488236, -0.5608405, ..., -1.4686831, 0.09638751, 0.7825242],
  [0.37519607, -1.7927319, -0.7238233, ..., -2.0191636, -0.2562493, 0.99556375],
  ...
  [-0.3615035, -0.25467384, -1.0531793, ..., -0.6962716, 0.56333536, 0.29293972],
  [-0.3615035, -0.25467384, -1.0531793, ..., -0.6962716, 0.56333536, 0.29293972],
  [-0.3615035, -0.25467384, -1.0531793, ..., -0.6962716, 0.56333536, 0.29293972]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after dropout Tensor {
  data:
[[[-0.122419156, -2.8830998, -0.37505093, ..., -1.3713326, 0.022751084, 0.85332894],
  [0.14310788, -2.5488236, -0.5608405, ..., -1.4686831, 0.09638751, 0.7825242],
  [0.37519607, -1.7927319, -0.7238233, ..., -2.0191636, -0.2562493, 0.99556375],
  ...
  [-0.3615035, -0.25467384, -1.0531793, ..., -0.6962716, 0.56333536, 0.29293972],
  [-0.3615035, -0.25467384, -1.0531793, ..., -0.6962716, 0.56333536, 0.29293972],
  [-0.3615035, -0.25467384, -1.0531793, ..., -0.6962716, 0.56333536, 0.29293972]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
x + residual Tensor {
  data:
[[[1.0937892, -3.4174764, -0.5214294, ..., -3.5202196, -2.2412927, -0.100693524],
  [0.66314495, -3.371131, -0.80453515, ..., -2.8463593, -1.4826452, -0.01638949],
  [1.6961393, -1.5301803, -1.974285, ..., -3.6829677, -1.557154, 0.78124326],
  ...
  [-0.32822114, -0.69524217, -1.6555269, ..., -1.359031, 1.3255978, 0.25963503],
  [-0.32822114, -0.69524217, -1.6555269, ..., -1.359031, 1.3255978, 0.25963503],
  [-0.32822114, -0.69524217, -1.6555269, ..., -1.359031, 1.3255978, 0.25963503]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after norm2 Tensor {
  data:
[[[0.6711257, -2.0806966, -0.31630892, ..., -2.1266332, -1.3839905, -0.04115354],
  [0.4101819, -2.035177, -0.48366013, ..., -1.7036585, -0.9045023, 0.014241436],
  [0.93697745, -0.8674761, -1.1270459, ..., -2.051817, -0.89469653, 0.4354905],
  ...
  [-0.21436891, -0.42944485, -0.99784386, ..., -0.80738664, 0.7587222, 0.14335138],
  [-0.21436891, -0.42944485, -0.99784386, ..., -0.80738664, 0.7587222, 0.14335138],
  [-0.21436891, -0.42944485, -0.99784386, ..., -0.80738664, 0.7587222, 0.14335138]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
encoder layer 1 Tensor {
  data:
[[[0.6711257, -2.0806966, -0.31630892, ..., -2.1266332, -1.3839905, -0.04115354],
  [0.4101819, -2.035177, -0.48366013, ..., -1.7036585, -0.9045023, 0.014241436],
  [0.93697745, -0.8674761, -1.1270459, ..., -2.051817, -0.89469653, 0.4354905],
  ...
  [-0.21436891, -0.42944485, -0.99784386, ..., -0.80738664, 0.7587222, 0.14335138],
  [-0.21436891, -0.42944485, -0.99784386, ..., -0.80738664, 0.7587222, 0.14335138],
  [-0.21436891, -0.42944485, -0.99784386, ..., -0.80738664, 0.7587222, 0.14335138]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
residual_path Tensor {
  data:
[[[0.6711257, -2.0806966, -0.31630892, ..., -2.1266332, -1.3839905, -0.04115354],
  [0.4101819, -2.035177, -0.48366013, ..., -1.7036585, -0.9045023, 0.014241436],
  [0.93697745, -0.8674761, -1.1270459, ..., -2.051817, -0.89469653, 0.4354905],
  ...
  [-0.21436891, -0.42944485, -0.99784386, ..., -0.80738664, 0.7587222, 0.14335138],
  [-0.21436891, -0.42944485, -0.99784386, ..., -0.80738664, 0.7587222, 0.14335138],
  [-0.21436891, -0.42944485, -0.99784386, ..., -0.80738664, 0.7587222, 0.14335138]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
start multihead attention
query: Tensor {
  data:
[[[[0.4558879, -0.21181905, -0.29514143, ..., -1.3359783, 0.24158184, -0.95881796],
   [0.31129527, -0.84804565, 0.046718296, ..., -1.6642747, 0.5923903, -1.355748],
   [0.6177548, -0.663268, -0.45112163, ..., -1.0559112, 0.48082903, -0.48482075],
   ...
   [0.42218542, -0.06926003, -0.84256285, ..., -1.1287421, 0.87180656, 0.06542435],
   [0.42218542, -0.06926003, -0.84256285, ..., -1.1287421, 0.87180656, 0.06542435],
   [0.42218542, -0.06926003, -0.84256285, ..., -1.1287421, 0.87180656, 0.06542435]],
  [[-0.046920776, 0.36741215, 1.4918656, ..., -0.38149118, -0.030565675, 0.8543174],
   [-0.3507469, 0.6364609, 1.5017409, ..., -0.48735127, -0.0425818, 0.9483843],
   [0.1551865, 1.0445954, 1.673517, ..., -0.5102185, -0.25923812, 0.720598],
   ...
   [-0.1633315, 1.1483299, 0.37225273, ..., -0.85782063, 0.26235884, 1.2737559],
   [-0.1633315, 1.1483299, 0.37225273, ..., -0.85782063, 0.26235884, 1.2737559],
   [-0.1633315, 1.1483299, 0.37225273, ..., -0.85782063, 0.26235884, 1.2737559]],
  [[0.2606367, 1.2466301, -0.48808053, ..., -0.089718394, 0.33400977, 1.0897877],
   [0.22431035, 1.2312422, -0.29927254, ..., 0.18723801, 0.55496114, 1.5183015],
   [0.24131016, 0.89873916, -0.0030009393, ..., 0.18775566, -0.07278665, 1.1437194],
   ...
   [-0.8349008, -0.81545717, 0.27497798, ..., 0.6869503, -0.17017038, 0.26856756],
   [-0.8349008, -0.81545717, 0.27497798, ..., 0.6869503, -0.17017038, 0.26856756],
   [-0.8349008, -0.81545717, 0.27497798, ..., 0.6869503, -0.17017038, 0.26856756]],
  [[-1.012515, -0.23872726, -1.0802586, ..., 0.8328379, 0.9794295, 0.024558375],
   [-1.0033785, -0.35491297, -0.8707425, ..., 0.7582962, 1.3465573, 0.24984804],
   [-0.79083717, -0.23903374, -0.53654504, ..., 0.6742738, 1.327909, 0.8089416],
   ...
   [-1.6962943, -0.93011135, 0.15099007, ..., 0.16708764, 0.4740832, -0.3290626],
   [-1.6962943, -0.93011135, 0.15099007, ..., 0.16708764, 0.4740832, -0.3290626],
   [-1.6962943, -0.93011135, 0.15099007, ..., 0.16708764, 0.4740832, -0.3290626]]]],
  shape:  [1, 4, 48, 64],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
query: Tensor {
  data:
[[[[0.3618655, -0.29796514, 0.2531599, ..., 0.68055737, 0.21609086, -0.06776613],
   [0.4249754, -0.17174977, 0.5064819, ..., 0.5366055, -0.111790344, 0.15973476],
   [0.14969215, -0.7762312, 0.16000128, ..., 0.07992204, -0.96686155, 0.37812942],
   ...
   [-1.1145757, -1.0056708, -0.6588892, ..., 0.6432812, 1.0184916, -0.9832302],
   [-1.1145757, -1.0056708, -0.6588892, ..., 0.6432812, 1.0184916, -0.9832302],
   [-1.1145757, -1.0056708, -0.6588892, ..., 0.6432812, 1.0184916, -0.9832302]],
  [[-0.47300145, 0.51400304, 0.48577687, ..., -1.3019025, -0.018367063, 0.2290801],
   [-0.37067196, 0.904309, 0.27667886, ..., -1.1727318, 0.049189594, 0.1834411],
   [-0.16375211, 0.7448338, 1.0199893, ..., -0.69258577, -0.38789248, 0.46233132],
   ...
   [-1.1085356, 0.6721799, 1.6544399, ..., -0.8846523, 0.023890555, 0.55221957],
   [-1.1085356, 0.6721799, 1.6544399, ..., -0.8846523, 0.023890555, 0.55221957],
   [-1.1085356, 0.6721799, 1.6544399, ..., -0.8846523, 0.023890555, 0.55221957]],
  [[-0.6677141, -0.17097212, -0.753704, ..., -0.3738911, 0.70816547, -0.07587548],
   [-0.28216928, 0.40480474, -0.59465003, ..., -0.4003401, 0.9076128, 0.14152087],
   [-0.8409868, 0.18402058, -0.44046015, ..., -0.6721505, 1.3384714, -0.26492095],
   ...
   [-0.74931175, 0.61463135, 0.654304, ..., -0.009416078, 0.8735739, 0.9685659],
   [-0.74931175, 0.61463135, 0.654304, ..., -0.009416078, 0.8735739, 0.9685659],
   [-0.74931175, 0.61463135, 0.654304, ..., -0.009416078, 0.8735739, 0.9685659]],
  [[-0.7311525, -0.31722128, -0.49951816, ..., 0.5901289, 0.2856469, -1.349321],
   [-0.78464687, -0.64451253, -0.336813, ..., 0.41774517, 0.6506343, -1.0219429],
   [-1.590683, -0.8798454, -0.13539815, ..., 0.7391034, 0.70648235, -0.70438105],
   ...
   [-1.317139, -1.7415888, -0.07726844, ..., -0.80901486, -0.14298639, -0.97616816],
   [-1.317139, -1.7415888, -0.07726844, ..., -0.80901486, -0.14298639, -0.97616816],
   [-1.317139, -1.7415888, -0.07726844, ..., -0.80901486, -0.14298639, -0.97616816]]]],
  shape:  [1, 4, 48, 64],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
value: Tensor {
  data:
[[[[0.03134187, -0.32999983, -0.010614339, ..., 1.3777273, -0.5167823, -0.39341912],
   [-0.2716033, -0.14554527, 0.37524918, ..., 1.3662841, -0.24041331, -1.0086051],
   [-0.54867095, 0.26235545, 0.2524429, ..., 1.2263423, -0.2959106, -0.19492124],
   ...
   [-0.7495167, -1.3024815, 0.557269, ..., 0.021452276, 0.39820537, 0.009094659],
   [-0.7495167, -1.3024815, 0.557269, ..., 0.021452276, 0.39820537, 0.009094659],
   [-0.7495167, -1.3024815, 0.557269, ..., 0.021452276, 0.39820537, 0.009094659]],
  [[-0.17094737, -1.0828781, -1.2773154, ..., -0.11865613, 0.41046968, 0.18172392],
   [-0.20005965, -0.94561225, -1.1122228, ..., -0.048579104, 0.2815076, 0.18581112],
   [-0.08337305, -1.2206588, -1.2974669, ..., -0.1783334, 0.45962894, 0.646912],
   ...
   [0.62920994, -0.8892889, -0.1964778, ..., -0.3987982, -1.0089893, 0.9488594],
   [0.62920994, -0.8892889, -0.1964778, ..., -0.3987982, -1.0089893, 0.9488594],
   [0.62920994, -0.8892889, -0.1964778, ..., -0.3987982, -1.0089893, 0.9488594]],
  [[0.5258324, 0.11245242, -1.1092957, ..., 0.27398697, -1.305227, -0.7369944],
   [0.55646676, 0.30007043, -0.83723074, ..., 0.3569234, -1.4864774, -0.69683367],
   [0.6168361, -0.3023591, -0.8687299, ..., 0.20447202, -1.2186929, -0.5531392],
   ...
   [-0.543582, -2.0885165, -0.25805506, ..., -0.58892244, -1.8748635, -0.13539991],
   [-0.543582, -2.0885165, -0.25805506, ..., -0.58892244, -1.8748635, -0.13539991],
   [-0.543582, -2.0885165, -0.25805506, ..., -0.58892244, -1.8748635, -0.13539991]],
  [[0.2310171, 0.5600647, -0.4277095, ..., 0.52743804, -1.6068658, -0.85959953],
   [0.09913174, 0.4957652, -0.3361571, ..., 0.4706018, -1.2117541, -0.14725281],
   [-0.44444662, 0.57622325, 0.18325315, ..., 0.18263163, -1.3900019, -0.20240119],
   ...
   [-0.09726201, 0.7316401, 0.18769799, ..., 0.0216985, -0.22506867, 0.38909075],
   [-0.09726201, 0.7316401, 0.18769799, ..., 0.0216985, -0.22506867, 0.38909075],
   [-0.09726201, 0.7316401, 0.18769799, ..., 0.0216985, -0.22506867, 0.38909075]]]],
  shape:  [1, 4, 48, 64],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
RELU VERSION
after mha forward Tensor {
  data:
[[[-0.072183624, -0.36293453, -0.1274743, ..., -0.08549329, 0.055025674, 0.0026651341],
  [-0.087516636, -0.34843308, -0.13365486, ..., -0.09606577, 0.03892549, -0.018695474],
  [-0.113050364, -0.31505343, -0.15040468, ..., -0.12612264, 0.054254837, 0.029775806],
  ...
  [-0.0755961, -0.34990975, -0.22809882, ..., -0.15735759, -0.023660716, -0.014244613],
  [-0.0755961, -0.34990975, -0.22809882, ..., -0.15735759, -0.023660716, -0.014244613],
  [-0.0755961, -0.34990975, -0.22809882, ..., -0.15735759, -0.023660716, -0.014244613]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after mha_foward, x + residual path Tensor {
  data:
[[[0.5989421, -2.4436312, -0.44378322, ..., -2.2121265, -1.3289648, -0.038488403],
  [0.32266527, -2.38361, -0.617315, ..., -1.7997242, -0.8655768, -0.004454038],
  [0.8239271, -1.1825296, -1.2774506, ..., -2.1779397, -0.8404417, 0.4652663],
  ...
  [-0.289965, -0.7793546, -1.2259427, ..., -0.9647442, 0.73506147, 0.12910676],
  [-0.289965, -0.7793546, -1.2259427, ..., -0.9647442, 0.73506147, 0.12910676],
  [-0.289965, -0.7793546, -1.2259427, ..., -0.9647442, 0.73506147, 0.12910676]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after pwff Tensor {
  data:
[[[-1.5408533, -0.50453174, -1.2158176, ..., -0.9899945, -0.89878416, -0.0045593567],
  [-1.3460057, -0.16294357, -1.1005158, ..., -0.88218504, -0.78281736, -0.040125426],
  [-1.6801865, 0.07628386, -1.3256389, ..., -0.72799605, -1.0138651, -0.11675295],
  ...
  [-1.4910365, -0.4005121, -1.4859811, ..., -0.62190187, -1.7568171, 0.4546385],
  [-1.4910365, -0.4005121, -1.4859811, ..., -0.62190187, -1.7568171, 0.4546385],
  [-1.4910365, -0.4005121, -1.4859811, ..., -0.62190187, -1.7568171, 0.4546385]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after dropout Tensor {
  data:
[[[-1.5408533, -0.50453174, -1.2158176, ..., -0.9899945, -0.89878416, -0.0045593567],
  [-1.3460057, -0.16294357, -1.1005158, ..., -0.88218504, -0.78281736, -0.040125426],
  [-1.6801865, 0.07628386, -1.3256389, ..., -0.72799605, -1.0138651, -0.11675295],
  ...
  [-1.4910365, -0.4005121, -1.4859811, ..., -0.62190187, -1.7568171, 0.4546385],
  [-1.4910365, -0.4005121, -1.4859811, ..., -0.62190187, -1.7568171, 0.4546385],
  [-1.4910365, -0.4005121, -1.4859811, ..., -0.62190187, -1.7568171, 0.4546385]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
x + residual Tensor {
  data:
[[[-0.96814287, -2.8334312, -1.6456785, ..., -3.0878582, -2.1910634, -0.030012991],
  [-1.0363666, -2.4347053, -1.6961027, ..., -2.5882325, -1.6273272, -0.032031253],
  [-0.88230515, -1.0565745, -2.5630903, ..., -2.8084974, -1.838825, 0.34528998],
  ...
  [-1.7720579, -1.158293, -2.6947422, ..., -1.5563889, -1.0332309, 0.59695834],
  [-1.7720579, -1.158293, -2.6947422, ..., -1.5563889, -1.0332309, 0.59695834],
  [-1.7720579, -1.158293, -2.6947422, ..., -1.5563889, -1.0332309, 0.59695834]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after norm2 Tensor {
  data:
[[[-0.5639955, -1.6955134, -0.9793925, ..., -1.8431264, -1.3410175, -0.03589768],
  [-0.62230974, -1.497622, -1.0384731, ..., -1.5875677, -1.0207775, -0.038069066],
  [-0.5212999, -0.64506346, -1.5568761, ..., -1.6989769, -1.1396526, 0.18893029],
  ...
  [-1.0142196, -0.67781, -1.5621672, ..., -0.90238684, -0.61039215, 0.31796026],
  [-1.0142196, -0.67781, -1.5621672, ..., -0.90238684, -0.61039215, 0.31796026],
  [-1.0142196, -0.67781, -1.5621672, ..., -0.90238684, -0.61039215, 0.31796026]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
after transformer encoder: Tensor {
  data:
[[[-0.5639955, -1.6955134, -0.9793925, ..., -1.8431264, -1.3410175, -0.03589768],
  [-0.62230974, -1.497622, -1.0384731, ..., -1.5875677, -1.0207775, -0.038069066],
  [-0.5212999, -0.64506346, -1.5568761, ..., -1.6989769, -1.1396526, 0.18893029],
  ...
  [-1.0142196, -0.67781, -1.5621672, ..., -0.90238684, -0.61039215, 0.31796026],
  [-1.0142196, -0.67781, -1.5621672, ..., -0.90238684, -0.61039215, 0.31796026],
  [-1.0142196, -0.67781, -1.5621672, ..., -0.90238684, -0.61039215, 0.31796026]]],
  shape:  [1, 48, 256],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
Tensor {
  data:
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.5638051, 1.495007, 1.495007, 1.3064632, 1.3331627, 1.3868146, 1.3868146, 1.4454508, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
  shape:  [48],
  device:  Cpu,
  backend:  "candle",
  kind:  "Float",
  dtype:  "f32",
}
Tensor {
  data:
[9],
  shape:  [1],
  device:  Cpu,
  backend:  "candle",
  kind:  "Int",
  dtype:  "i64",
}
